<%- include('partials/head') -%>

<main>
  <%- include('partials/nav') -%>
  <div>
    <img src="<%= base_url + movieDetails.poster_path %>" class="img-fluid rounded-start" alt="movie poster" style = "min-width: 94px; width: 94px;height: 141px;">
  </div>

  <div>
    <div class="card-body">
        <h5 class="card-title"><%= movieDetails.title %></h5>
        <p class="card-text" style="overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;"><%= movieDetails.overview %></p>
    </div>
  </div>

  <!-- Button trigger modal -->
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Launch demo modal
  </button>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Reviewing <%= movieDetails.title %>...</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <!-- Review Box -->
          <div class="form-group">
            <label for="review"></label>
            <textarea class="form-control" id="review" rows="10" placeholder="Add a review..."></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>

  <div class="mt-5">
    <h2>Add a review</h2>
    <form action="/review/createReview/<%= movieId %>" method="POST">
      <div class="mb-3">
          <label for="review" class="form-label">Review</label>
          <input type="text" class="form-control" id="review" name="review" placeholder="Add a review...">
      </div>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>

  <ul>
    <% for(var i=0; i < reviews.length; i++) {%>
      <li class="col-6 justify-content-between mt-5">
        <p><%= reviews[i].userName%> <%= reviews[i].review%></p>
        <form class="col-1" action="/review/likeReview/<%= reviews[i]._id%>?_method=PUT" method="POST">
          <button class="btn btn-primary fa fa-heart" type="submit"></button>
        </form>
        <h3 class="col-3">Likes: <%= reviews[i].reviewLikes %></h3>
      </li>
    <% } %>
    
  </ul>     
</main>

<%- include('partials/footer') -%>


